# 模板功能简化设计需求

## 需求背景

原有的模板功能过于复杂，需要简化设计以便更好地完成功能实现。

## 功能需求

### 1. 菜单结构调整
- 将模板菜单改为：新建模板、保存模板、分隔线，然后是各个已有模板名称
- 在每个模板后面添加删除符号和修改符号
- 移除原有的复杂模板管理对话框

### 2. 编辑区集成
- 模板编辑直接在现有的编辑区进行，不需要单独的编辑界面
- 当用户点击新建模板或修改模板时，先检查编辑区是否为空（允许纯空白符）
- 如编辑区不为空，提示用户必须手动保存工作区内容并清空后才能继续操作

### 3. 保存流程优化
- 用户编辑完成后，点击保存模板弹出对话框
- 用户可以输入模板名称，系统检查是否重名
- 如果没有重名，允许保存
- 如果不是在编辑模板状态下，「保存模板」按钮要灰掉

### 4. 状态指示
- 添加编辑状态指示器，让用户清楚当前是否在编辑模板
- 显示当前编辑的模板名称或"新建模板"状态

## 实现细节

### 状态管理
- 在 stores 中添加 `isTemplateEditing` 和 `currentEditingTemplateId` 状态
- 用于跟踪当前的模板编辑状态

### 组件改造
- 重构 `TemplateDropdown.vue` 组件，简化界面结构
- 移除 `TemplateManagerDialog` 组件的依赖
- 添加模板名称输入对话框

### 用户体验
- 提供清晰的状态反馈
- 防止用户意外丢失编辑内容
- 简化操作流程，减少学习成本

## 技术实现

### 核心功能
1. **新建模板**：检查编辑区内容 → 清空确认 → 进入编辑状态
2. **编辑模板**：检查编辑区内容 → 清空确认 → 加载模板内容 → 进入编辑状态
3. **保存模板**：输入名称 → 重名检查 → 保存确认 → 退出编辑状态
4. **删除模板**：确认删除 → 从列表移除
5. **状态指示**：实时显示当前编辑状态和模板名称

### 状态控制
- 非编辑状态：保存按钮禁用，可以插入模板
- 编辑状态：保存按钮启用，禁止插入其他模板
- 内容检查：防止意外覆盖用户内容

## 预期效果

通过这次简化，模板功能将更加直观易用，用户可以：
- 快速创建和编辑模板
- 清楚了解当前操作状态
- 避免意外丢失编辑内容
- 享受更流畅的使用体验

---

**创建时间**：2025年1月27日
**状态**：已完成实现
**相关文件**：
- `stores/index.ts` - 状态管理
- `components/CodemirrorEditor/TemplateDropdown.vue` - 主要组件
- `components/CodemirrorEditor/EditorHeader/index.vue` - 状态指示器
